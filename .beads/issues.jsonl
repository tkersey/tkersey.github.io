{"id":"blog-0yg","title":"Zig static blog for GitHub Pages (minimal)","description":"Build a minimal static blog generator in Zig 0.15.2 for https://tkersey.github.io.\n\nRequirements:\n- Content: Markdown posts in posts/*.md with YAML front matter delimited by --- ... ---.\n- Front matter: required fields title + date; simple YAML subset (scalars + tags list). Optional fields may include description, tags, draft, slug.\n- Markdown flavor: GFM-ish (tables/strikethrough/autolinks if supported by chosen renderer).\n- Output: flat URLs (slug.html), index.html, feed.xml (RSS 2.0), style.css, optional minimal JS only if justified.\n- Preview: zig build serve serves the generated site and watches for changes to rebuild (manual browser refresh is fine).\n- Deploy: GitHub Actions builds and deploys to GitHub Pages; generated site is NOT committed.\n- First version: skip syntax highlighting.","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-13T12:56:22.878632-08:00","updated_at":"2025-12-13T12:57:59.199789-08:00"}
{"id":"blog-0yg.1","title":"Repo + config skeleton","description":"Add baseline repo files (README, .gitignore), site.yml schema, and expected directories (posts/, static/, dist/).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T12:57:59.247225-08:00","updated_at":"2025-12-13T13:08:14.205062-08:00","closed_at":"2025-12-13T13:08:14.205062-08:00","dependencies":[{"issue_id":"blog-0yg.1","depends_on_id":"blog-0yg","type":"parent-child","created_at":"2025-12-13T12:57:59.247696-08:00","created_by":"daemon"}]}
{"id":"blog-0yg.2","title":"Zig project scaffold + CLI","description":"Scaffold the Zig 0.15.2 project and build/serve workflow.\n\n- Adds `blog` executable with `build` and `serve` subcommands.\n- `zig build` (default) generates placeholder HTML into `dist/` from `posts/*.md`.\n- `zig build serve` serves `dist/` locally (no watch/rebuild yet).\n\nWhere:\n- `build.zig`, `build.zig.zon`\n- `src/main.zig`, `src/cli.zig`, `src/site.zig`, `src/server.zig`\n\nVerification:\n- `zig fmt build.zig src/*.zig`\n- `zig build`\n- `zig build test`","design":"- Zig 0.15 build system uses `root_module`; create a private module via `b.createModule` and pass it to `b.addExecutable`/`b.addTest`.\n- Make `zig build` generate `dist/` by setting `b.default_step` to a run step that invokes `blog build`.\n- Implement a minimal `blog serve` HTTP file server using `std.net` + `std.http.Server`, with basic path traversal protection.\n- Keep generated output git-clean by writing under `dist/` (which already contains its own `.gitignore`).","acceptance_criteria":"- `zig fmt build.zig src/*.zig`\n- `zig build` generates `dist/index.html`\n- `zig build test`\n- `zig build serve` starts a server on http://127.0.0.1:8080 (or custom host/port via `blog serve --host/--port`)","notes":"Closure Notes\n- Outcome: Zig project scaffolded with `blog` CLI + `zig build` steps; `zig build` generates placeholder pages into `dist/`, and `zig build serve` serves `dist/` locally.\n- Key learnings: Zig 0.15 uses `zig init` (no `zig init-exe`) and build definitions require `root_module`/`createModule`.\n- Decisions + rationale: Set `b.default_step` to site generation so `zig build` produces the artifact; keep `serve` minimal (no watch) but safe against `..` traversal.\n- Constraints / invariants discovered: `dist/` is generated; preserve `dist/.gitignore`; only serve files under `dist/`.\n- Verification (exact commands + results):\n  - `zig fmt build.zig src/*.zig`\n  - `zig build`\n  - `zig build test`\n- Commands run (copy/paste safe):\n  - `zig build`\n  - `zig build test`\n  - `zig fmt build.zig src/*.zig`\n- Files / symbols touched:\n  - `build.zig`\n  - `build.zig.zon`\n  - `src/main.zig` (`main`)\n  - `src/cli.zig` (`run`)\n  - `src/site.zig` (`generate`)\n  - `src/server.zig` (`serve`)\n  - `README.md`\n  - `.gitignore`\n- External refs (PR/commit/issues): blog-0yg.2\n- Follow-ups created (ids + why): None\n- Search keywords / phrases: zig 0.15 root_module createModule addExecutable, std.http.Server static file server","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-13T12:57:59.297244-08:00","updated_at":"2025-12-13T13:40:18.318286-08:00","closed_at":"2025-12-13T13:40:18.318286-08:00","labels":["decision","memory","runbook"],"dependencies":[{"issue_id":"blog-0yg.2","depends_on_id":"blog-0yg","type":"parent-child","created_at":"2025-12-13T12:57:59.297647-08:00","created_by":"daemon"},{"issue_id":"blog-0yg.2","depends_on_id":"blog-0yg.1","type":"blocks","created_at":"2025-12-13T12:57:59.669163-08:00","created_by":"daemon"}]}
{"id":"blog-0yg.3","title":"Pick + integrate Markdown renderer","description":"Evaluate Zig-native Markdown options (koino/zigdown/zmd/etc) vs C-based cmark-gfm. Choose smallest pragmatic option that supports GFM-ish output on Zig 0.15.2 and integrate via build.zig.zon.","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-13T12:57:59.347885-08:00","updated_at":"2025-12-13T15:28:54.583277-08:00","dependencies":[{"issue_id":"blog-0yg.3","depends_on_id":"blog-0yg","type":"parent-child","created_at":"2025-12-13T12:57:59.348372-08:00","created_by":"daemon"},{"issue_id":"blog-0yg.3","depends_on_id":"blog-0yg.2","type":"blocks","created_at":"2025-12-13T12:57:59.699619-08:00","created_by":"daemon"}]}
{"id":"blog-0yg.4","title":"Parse YAML front matter","description":"Implement YAML front matter extraction + parsing for posts and integrate it into site generation.\n\nOutcome:\n- `site.generate` parses leading `---` front matter and uses `title` for page/index titles.\n- Required fields: `title`, `date` (ISO `YYYY-MM-DD`); optional: `description`, `tags`, `draft`, `slug`.\n- Draft posts (`draft: true`) are skipped during generation.\n- Output filenames use the provided `slug` (if present) or filename stem, normalized via existing `slugify`.\n\nWhere:\n- `src/front_matter.zig`\n- `src/site.zig`\n- `build.zig`\n\nVerification:\n- `zig fmt build.zig src/*.zig`\n- `zig build`\n- `zig build test`","design":"- Avoided a full YAML dependency: implemented a small, line-based parser supporting `key: value`, `tags:` block lists (`- item`), and simple inline lists (`tags: [a, b]`).\n- Front matter is required; missing delimiters or required keys fails fast.\n- Parsed dates into a small `Date` struct (YYYY-MM-DD) to support later sorting/feed generation.\n- Reused `slugify` to sanitize user-provided `slug` values and keep output filenames safe.","acceptance_criteria":"- `zig fmt build.zig src/*.zig`\n- `zig build` generates `dist/index.html` using front matter titles\n- `zig build test`\n- Draft posts (`draft: true`) do not appear in `dist/index.html`","notes":"Closure Notes\n- Outcome:\n  - Added YAML front matter parser + tests and integrated it into generation.\n  - Generator now requires `title` + `date`, parses optional `description/tags/draft/slug`, and skips drafts.\n- Key learnings:\n  - A simple, purpose-built parser is enough for the constrained front matter subset we need right now.\n- Decisions + rationale:\n  - Keep the YAML subset intentionally small to avoid extra deps until the Markdown renderer choice lands.\n  - Parse date eagerly to a comparable struct for future sort/feed work.\n- Constraints / invariants discovered:\n  - Posts must begin with `---` front matter and include `title` + `date`.\n  - Slugs must be normalized/sanitized before becoming output filenames.\n- Verification (exact commands + results):\n  - `zig fmt build.zig src/*.zig`\n  - `zig build`\n  - `zig build test`\n- Commands run (copy/paste safe):\n  - `zig fmt build.zig src/*.zig`\n  - `zig build`\n  - `zig build test`\n- Files / symbols touched:\n  - `src/front_matter.zig` (`parse`, `splitFrontMatter`, `FrontMatter`, `Date`)\n  - `src/site.zig` (`generate` now uses front matter; draft skipping)\n  - `build.zig` (include `src/front_matter.zig` in `zig build test`)\n- External refs (PR/commit/issues): blog-0yg.4; PR #3; commit 10c04f3\n- Follow-ups created (ids + why): None\n- Search keywords / phrases: front matter parser, YAML subset, tags list, draft true skip, ISO date parse","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T12:57:59.397194-08:00","updated_at":"2025-12-13T14:21:02.667631-08:00","closed_at":"2025-12-13T14:21:02.667631-08:00","external_ref":"gh-3","dependencies":[{"issue_id":"blog-0yg.4","depends_on_id":"blog-0yg","type":"parent-child","created_at":"2025-12-13T12:57:59.397653-08:00","created_by":"daemon"},{"issue_id":"blog-0yg.4","depends_on_id":"blog-0yg.2","type":"blocks","created_at":"2025-12-13T12:57:59.73081-08:00","created_by":"daemon"}]}
{"id":"blog-0yg.5","title":"Generate HTML pages","description":"Generate index.html + per-post slug.html using a minimal template (no dark mode). Ensure links + assets work for root Pages URL.","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-13T12:57:59.445129-08:00","updated_at":"2025-12-13T12:57:59.445129-08:00","dependencies":[{"issue_id":"blog-0yg.5","depends_on_id":"blog-0yg","type":"parent-child","created_at":"2025-12-13T12:57:59.445543-08:00","created_by":"daemon"},{"issue_id":"blog-0yg.5","depends_on_id":"blog-0yg.3","type":"blocks","created_at":"2025-12-13T12:57:59.760605-08:00","created_by":"daemon"},{"issue_id":"blog-0yg.5","depends_on_id":"blog-0yg.4","type":"blocks","created_at":"2025-12-13T12:57:59.792883-08:00","created_by":"daemon"}]}
{"id":"blog-0yg.6","title":"Generate RSS feed","description":"Generate RSS 2.0 feed at feed.xml with correct base_url (https://tkersey.github.io), dates, and descriptions.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-13T12:57:59.493752-08:00","updated_at":"2025-12-13T12:57:59.493752-08:00","dependencies":[{"issue_id":"blog-0yg.6","depends_on_id":"blog-0yg","type":"parent-child","created_at":"2025-12-13T12:57:59.494211-08:00","created_by":"daemon"},{"issue_id":"blog-0yg.6","depends_on_id":"blog-0yg.4","type":"blocks","created_at":"2025-12-13T12:57:59.82382-08:00","created_by":"daemon"}]}
{"id":"blog-0yg.7","title":"Copy static assets","description":"Copy static/ into dist/ preserving paths (and include style.css).","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-13T12:57:59.541468-08:00","updated_at":"2025-12-13T12:57:59.541468-08:00","dependencies":[{"issue_id":"blog-0yg.7","depends_on_id":"blog-0yg","type":"parent-child","created_at":"2025-12-13T12:57:59.541888-08:00","created_by":"daemon"},{"issue_id":"blog-0yg.7","depends_on_id":"blog-0yg.1","type":"blocks","created_at":"2025-12-13T12:57:59.855058-08:00","created_by":"daemon"}]}
{"id":"blog-0yg.8","title":"Preview server + watch/rebuild","description":"Implement a tiny HTTP file server for dist/ and a watcher (polling is fine) that rebuilds on changes to posts/, static/, templates, or site.yml.","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-13T12:57:59.5882-08:00","updated_at":"2025-12-13T12:57:59.5882-08:00","dependencies":[{"issue_id":"blog-0yg.8","depends_on_id":"blog-0yg","type":"parent-child","created_at":"2025-12-13T12:57:59.588664-08:00","created_by":"daemon"},{"issue_id":"blog-0yg.8","depends_on_id":"blog-0yg.2","type":"blocks","created_at":"2025-12-13T12:57:59.88548-08:00","created_by":"daemon"},{"issue_id":"blog-0yg.8","depends_on_id":"blog-0yg.5","type":"blocks","created_at":"2025-12-13T12:57:59.915693-08:00","created_by":"daemon"}]}
{"id":"blog-0yg.9","title":"CI deploy to GitHub Pages","description":"Add GitHub Actions workflow to build with Zig and deploy dist/ to Pages (no generated files committed).","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-13T12:57:59.63395-08:00","updated_at":"2025-12-13T12:57:59.63395-08:00","dependencies":[{"issue_id":"blog-0yg.9","depends_on_id":"blog-0yg","type":"parent-child","created_at":"2025-12-13T12:57:59.63436-08:00","created_by":"daemon"},{"issue_id":"blog-0yg.9","depends_on_id":"blog-0yg.2","type":"blocks","created_at":"2025-12-13T12:57:59.946029-08:00","created_by":"daemon"},{"issue_id":"blog-0yg.9","depends_on_id":"blog-0yg.5","type":"blocks","created_at":"2025-12-13T12:57:59.976817-08:00","created_by":"daemon"}]}
{"id":"blog-ljd","title":"Harden preview server + generator (review follow-ups)","description":"Hardened the preview server + placeholder generator based on review findings.\n\nOutcome:\n- Serve is now bounded (no thread-per-connection) and file responses are streamed (no whole-file reads).\n- Generated HTML is deterministic and safe against HTML injection from filenames (slugified output names + HTML-escaped titles/links).\n- CLI invalid args now print usage and exit with code 2 (instead of surfacing `InvalidArgs`).\n- `zig build` no longer breaks when `-Dtarget` is non-native (the build-time tool always compiles for host; a warning is emitted).\n- `zig build test` now actually runs tests for `src/cli.zig`, `src/site.zig`, and `src/server.zig`.\n\nWhere:\n- `build.zig`\n- `src/main.zig`, `src/cli.zig`, `src/site.zig`, `src/server.zig`\n\nVerification:\n- `zig fmt build.zig src/*.zig`\n- `zig build`\n- `zig build test`\n- `zig build -Dtarget=x86_64-linux`","design":"- Safety over concurrency: switched the HTTP preview server to handle one connection at a time to eliminate thread/FD exhaustion from connection floods.\n- O(1) memory serving: replaced `readToEndAlloc` with `respondStreaming` and chunked file reads.\n- Stronger HTML invariants: slugify output filenames and HTML-escape all user-derived strings before emitting markup.\n- Deterministic output: sort post filenames prior to generation.\n- Build-system footgun: accept `-Dtarget` for ergonomics but warn and ignore it because the generator is a host tool.\n- Tests: run `addTest` on each module file to execute their `test {}` blocks.","acceptance_criteria":"- `zig fmt build.zig src/*.zig`\n- `zig build` generates `dist/index.html`\n- `zig build test` runs module tests successfully\n- `zig build -Dtarget=x86_64-linux` succeeds and prints a warning about `-Dtarget` being ignored","notes":"Closure Notes\n- Outcome: preview server no longer spawns unbounded threads and streams file responses; generator output is deterministic and HTML-safe; CLI prints usage on invalid args; build ignores non-native `-Dtarget` with a warning; `zig build test` runs real tests.\n- Key learnings: Zig 0.15 `std.ArrayList` is allocator-arg (unmanaged) by default; per-file `zig test` / `addTest` is needed to run tests in those modules.\n- Decisions + rationale: choose serial serving + streaming to remove the crash/exhaustion class with minimal complexity; enforce HTML escaping + slugging to make unsafe input inert.\n- Constraints / invariants discovered: build-time tools must run on host; user-derived HTML must be escaped; output should be deterministic for identical inputs.\n- Verification (exact commands + results):\n  - `zig fmt build.zig src/*.zig`\n  - `zig build`\n  - `zig build test`\n  - `zig build -Dtarget=x86_64-linux` (warns, still succeeds)\n- Commands run (copy/paste safe):\n  - `zig fmt build.zig src/*.zig`\n  - `zig build`\n  - `zig build test`\n  - `zig build -Dtarget=x86_64-linux`\n- Files / symbols touched:\n  - `build.zig` (`test` step, host tool target)\n  - `src/main.zig` (`main` return `!u8`, leak assert)\n  - `src/cli.zig` (arg handling + test)\n  - `src/server.zig` (serial accept + streaming)\n  - `src/site.zig` (`slugify`, escaping, deterministic generation)\n- External refs (PR/commit/issues): blog-ljd; PR #2\n- Follow-ups created (ids + why): None\n- Search keywords / phrases: respondStreaming, std.ArrayList empty append allocator, slugify html escape","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T13:52:06.84098-08:00","updated_at":"2025-12-13T14:03:12.663449-08:00","closed_at":"2025-12-13T14:03:12.663449-08:00","labels":["decision","invariant","runbook","security"],"dependencies":[{"issue_id":"blog-ljd","depends_on_id":"blog-0yg.2","type":"discovered-from","created_at":"2025-12-13T13:52:06.842749-08:00","created_by":"daemon"}]}
{"id":"blog-qcs","title":"Harden front matter parsing invariants","description":"Harden YAML front matter + generation invariants to remove unsoundness and common footguns.\n\nOutcome:\n- `front_matter.parse` now returns an owned `ParsedPost` (stores an owned `raw` buffer) so slices like `title/date/body` stay valid even if the caller frees their input.\n- `parseOwnedBuffer` supports zero-copy parsing when the caller already has an owned buffer.\n- Inline comments now work with quoted scalars (`date: \"2025-12-13\" # comment`) and are stripped from block-list tag items (`- zig # note`).\n- Dates are strictly `YYYY-MM-DD` (no trailing junk) and validated as real calendar dates.\n- Generator enforces unique slugs (duplicate slugs error instead of silently suffixing).\n- Generation errors now log the post filename for context.\n\nWhere:\n- `src/front_matter.zig`\n- `src/site.zig`\n\nVerification:\n- `zig fmt build.zig src/*.zig`\n- `zig build`\n- `zig build test`","design":"- Strengthened lifetime invariant: `ParsedPost` owns `raw` and all parsed slices are views into that buffer; `deinit` frees `raw` + the tags pointer list.\n- Kept a fast path: `parseOwnedBuffer` takes ownership of an already-allocated buffer (used by the generator) to avoid extra copies.\n- Chose strictness for stability:\n  - Dates must be exactly `YYYY-MM-DD` and calendar-valid.\n  - Slugs must be unique; collisions fail fast to avoid unstable URLs.\n- Diagnostics: used `std.log.warn` (not `err`) so unit tests can assert failure cases without failing on error-level logs.","acceptance_criteria":"- `zig fmt build.zig src/*.zig`\n- `zig build`\n- `zig build test`\n- Posts with `date: \"YYYY-MM-DD\" # comment` parse successfully\n- Duplicate `slug:` values fail generation with `error.DuplicateSlug`","notes":"Closure Notes\n- Outcome:\n  - Removed slice-lifetime footgun by making parsed posts own their backing buffer.\n  - Tightened parsing (comments/date validation) and generation invariants (unique slugs) to prevent silent bad metadata and unstable URLs.\n- Key learnings:\n  - Zig 0.15 requires `@mod/@rem` for signed remainder checks.\n  - Zig test runner treats `std.log.err` output as a test failure; prefer warn/info for diagnostic context in negative tests.\n- Decisions + rationale:\n  - Prefer owned parsing as the safe default; provide an explicit zero-copy ownership-taking API for performance.\n  - Fail on duplicate slugs instead of auto-suffixing to keep URLs stable.\n- Constraints / invariants discovered:\n  - Front matter dates are intentionally a strict `YYYY-MM-DD` subset.\n  - Every output slug must be globally unique across posts.\n- Verification (exact commands + results):\n  - `zig fmt build.zig src/*.zig`\n  - `zig build`\n  - `zig build test`\n- Commands run (copy/paste safe):\n  - `zig fmt build.zig src/*.zig`\n  - `zig build`\n  - `zig build test`\n- Files / symbols touched:\n  - `src/front_matter.zig` (`ParsedPost.raw`, `parseOwnedBuffer`, `stripInlineComment`, `Date.parseIso8601`)\n  - `src/site.zig` (owned parsing + duplicate slug enforcement + diagnostics)\n- External refs (PR/commit/issues): blog-qcs; PR #3\n- Follow-ups created (ids + why): None\n- Search keywords / phrases: use-after-free slices, owned parsed buffer, duplicate slug error, inline comment quoted scalar, YYYY-MM-DD validation","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T15:12:50.825292-08:00","updated_at":"2025-12-13T15:20:15.704886-08:00","closed_at":"2025-12-13T15:20:15.704886-08:00","external_ref":"gh-3-followup","dependencies":[{"issue_id":"blog-qcs","depends_on_id":"blog-0yg.4","type":"discovered-from","created_at":"2025-12-13T15:12:50.826607-08:00","created_by":"daemon"}]}
